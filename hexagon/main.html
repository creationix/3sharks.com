<html>
</head>
<title>Hexagon: By Tim Caswell</title> 
<MAP NAME="map">
<area shape='poly' coords=' 149 , 37 , 193 , 15 , 237 , 37 , 237 , 93 , 193 , 115 , 149 , 93 ' onMouseover='highlight( 2 , 0 )' onmouseout='hide()' onclick='sclick( 2 , 0 )'>
<area shape='poly' coords=' 240 , 37 , 284 , 15 , 328 , 37 , 328 , 93 , 284 , 115 , 240 , 93 ' onMouseover='highlight( 3 , 0 )' onmouseout='hide()' onclick='sclick( 3 , 0 )'>
<area shape='poly' coords=' 331 , 37 , 375 , 15 , 419 , 37 , 419 , 93 , 375 , 115 , 331 , 93 ' onMouseover='highlight( 4 , 0 )' onmouseout='hide()' onclick='sclick( 4 , 0 )'>
<area shape='poly' coords=' 422 , 37 , 466 , 15 , 510 , 37 , 510 , 93 , 466 , 115 , 422 , 93 ' onMouseover='highlight( 5 , 0 )' onmouseout='hide()' onclick='sclick( 5 , 0 )'>
<area shape='poly' coords=' 102 , 115 , 146 , 93 , 190 , 115 , 190 , 171 , 146 , 193 , 102 , 171 ' onMouseover='highlight( 1 , 1 )' onmouseout='hide()' onclick='sclick( 1 , 1 )'>
<area shape='poly' coords=' 193 , 115 , 237 , 93 , 281 , 115 , 281 , 171 , 237 , 193 , 193 , 171 ' onMouseover='highlight( 2 , 1 )' onmouseout='hide()' onclick='sclick( 2 , 1 )'>
<area shape='poly' coords=' 284 , 115 , 328 , 93 , 372 , 115 , 372 , 171 , 328 , 193 , 284 , 171 ' onMouseover='highlight( 3 , 1 )' onmouseout='hide()' onclick='sclick( 3 , 1 )'>
<area shape='poly' coords=' 375 , 115 , 419 , 93 , 463 , 115 , 463 , 171 , 419 , 193 , 375 , 171 ' onMouseover='highlight( 4 , 1 )' onmouseout='hide()' onclick='sclick( 4 , 1 )'>
<area shape='poly' coords=' 466 , 115 , 510 , 93 , 554 , 115 , 554 , 171 , 510 , 193 , 466 , 171 ' onMouseover='highlight( 5 , 1 )' onmouseout='hide()' onclick='sclick( 5 , 1 )'>
<area shape='poly' coords=' 58 , 193 , 102 , 171 , 146 , 193 , 146 , 249 , 102 , 271 , 58 , 249 ' onMouseover='highlight( 1 , 2 )' onmouseout='hide()' onclick='sclick( 1 , 2 )'>
<area shape='poly' coords=' 149 , 193 , 193 , 171 , 237 , 193 , 237 , 249 , 193 , 271 , 149 , 249 ' onMouseover='highlight( 2 , 2 )' onmouseout='hide()' onclick='sclick( 2 , 2 )'>
<area shape='poly' coords=' 240 , 193 , 284 , 171 , 328 , 193 , 328 , 249 , 284 , 271 , 240 , 249 ' onMouseover='highlight( 3 , 2 )' onmouseout='hide()' onclick='sclick( 3 , 2 )'>
<area shape='poly' coords=' 331 , 193 , 375 , 171 , 419 , 193 , 419 , 249 , 375 , 271 , 331 , 249 ' onMouseover='highlight( 4 , 2 )' onmouseout='hide()' onclick='sclick( 4 , 2 )'>
<area shape='poly' coords=' 422 , 193 , 466 , 171 , 510 , 193 , 510 , 249 , 466 , 271 , 422 , 249 ' onMouseover='highlight( 5 , 2 )' onmouseout='hide()' onclick='sclick( 5 , 2 )'>
<area shape='poly' coords=' 513 , 193 , 557 , 171 , 601 , 193 , 601 , 249 , 557 , 271 , 513 , 249 ' onMouseover='highlight( 6 , 2 )' onmouseout='hide()' onclick='sclick( 6 , 2 )'>
<area shape='poly' coords=' 11 , 271 , 55 , 249 , 99 , 271 , 99 , 327 , 55 , 349 , 11 , 327 ' onMouseover='highlight( 0 , 3 )' onmouseout='hide()' onclick='sclick( 0 , 3 )'>
<area shape='poly' coords=' 102 , 271 , 146 , 249 , 190 , 271 , 190 , 327 , 146 , 349 , 102 , 327 ' onMouseover='highlight( 1 , 3 )' onmouseout='hide()' onclick='sclick( 1 , 3 )'>
<area shape='poly' coords=' 193 , 271 , 237 , 249 , 281 , 271 , 281 , 327 , 237 , 349 , 193 , 327 ' onMouseover='highlight( 2 , 3 )' onmouseout='hide()' onclick='sclick( 2 , 3 )'>
<area shape='poly' coords=' 284 , 271 , 328 , 249 , 372 , 271 , 372 , 327 , 328 , 349 , 284 , 327 ' onMouseover='highlight( 3 , 3 )' onmouseout='hide()' onclick='sclick( 3 , 3 )'>
<area shape='poly' coords=' 375 , 271 , 419 , 249 , 463 , 271 , 463 , 327 , 419 , 349 , 375 , 327 ' onMouseover='highlight( 4 , 3 )' onmouseout='hide()' onclick='sclick( 4 , 3 )'>
<area shape='poly' coords=' 466 , 271 , 510 , 249 , 554 , 271 , 554 , 327 , 510 , 349 , 466 , 327 ' onMouseover='highlight( 5 , 3 )' onmouseout='hide()' onclick='sclick( 5 , 3 )'>
<area shape='poly' coords=' 557 , 271 , 601 , 249 , 645 , 271 , 645 , 327 , 601 , 349 , 557 , 327 ' onMouseover='highlight( 6 , 3 )' onmouseout='hide()' onclick='sclick( 6 , 3 )'>
<area shape='poly' coords=' 58 , 349 , 102 , 327 , 146 , 349 , 146 , 405 , 102 , 427 , 58 , 405 ' onMouseover='highlight( 1 , 4 )' onmouseout='hide()' onclick='sclick( 1 , 4 )'>
<area shape='poly' coords=' 149 , 349 , 193 , 327 , 237 , 349 , 237 , 405 , 193 , 427 , 149 , 405 ' onMouseover='highlight( 2 , 4 )' onmouseout='hide()' onclick='sclick( 2 , 4 )'>
<area shape='poly' coords=' 240 , 349 , 284 , 327 , 328 , 349 , 328 , 405 , 284 , 427 , 240 , 405 ' onMouseover='highlight( 3 , 4 )' onmouseout='hide()' onclick='sclick( 3 , 4 )'>
<area shape='poly' coords=' 331 , 349 , 375 , 327 , 419 , 349 , 419 , 405 , 375 , 427 , 331 , 405 ' onMouseover='highlight( 4 , 4 )' onmouseout='hide()' onclick='sclick( 4 , 4 )'>
<area shape='poly' coords=' 422 , 349 , 466 , 327 , 510 , 349 , 510 , 405 , 466 , 427 , 422 , 405 ' onMouseover='highlight( 5 , 4 )' onmouseout='hide()' onclick='sclick( 5 , 4 )'>
<area shape='poly' coords=' 513 , 349 , 557 , 327 , 601 , 349 , 601 , 405 , 557 , 427 , 513 , 405 ' onMouseover='highlight( 6 , 4 )' onmouseout='hide()' onclick='sclick( 6 , 4 )'>
<area shape='poly' coords=' 102 , 427 , 146 , 405 , 190 , 427 , 190 , 483 , 146 , 505 , 102 , 483 ' onMouseover='highlight( 1 , 5 )' onmouseout='hide()' onclick='sclick( 1 , 5 )'>
<area shape='poly' coords=' 193 , 427 , 237 , 405 , 281 , 427 , 281 , 483 , 237 , 505 , 193 , 483 ' onMouseover='highlight( 2 , 5 )' onmouseout='hide()' onclick='sclick( 2 , 5 )'>
<area shape='poly' coords=' 284 , 427 , 328 , 405 , 372 , 427 , 372 , 483 , 328 , 505 , 284 , 483 ' onMouseover='highlight( 3 , 5 )' onmouseout='hide()' onclick='sclick( 3 , 5 )'>
<area shape='poly' coords=' 375 , 427 , 419 , 405 , 463 , 427 , 463 , 483 , 419 , 505 , 375 , 483 ' onMouseover='highlight( 4 , 5 )' onmouseout='hide()' onclick='sclick( 4 , 5 )'>
<area shape='poly' coords=' 466 , 427 , 510 , 405 , 554 , 427 , 554 , 483 , 510 , 505 , 466 , 483 ' onMouseover='highlight( 5 , 5 )' onmouseout='hide()' onclick='sclick( 5 , 5 )'>
<area shape='poly' coords=' 149 , 505 , 193 , 483 , 237 , 505 , 237 , 561 , 193 , 583 , 149 , 561 ' onMouseover='highlight( 2 , 6 )' onmouseout='hide()' onclick='sclick( 2 , 6 )'>
<area shape='poly' coords=' 240 , 505 , 284 , 483 , 328 , 505 , 328 , 561 , 284 , 583 , 240 , 561 ' onMouseover='highlight( 3 , 6 )' onmouseout='hide()' onclick='sclick( 3 , 6 )'>
<area shape='poly' coords=' 331 , 505 , 375 , 483 , 419 , 505 , 419 , 561 , 375 , 583 , 331 , 561 ' onMouseover='highlight( 4 , 6 )' onmouseout='hide()' onclick='sclick( 4 , 6 )'>
<area shape='poly' coords=' 422 , 505 , 466 , 483 , 510 , 505 , 510 , 561 , 466 , 583 , 422 , 561 ' onMouseover='highlight( 5 , 6 )' onmouseout='hide()' onclick='sclick( 5 , 6 )'>
</MAP>


<SCRIPT LANGUAGE="JavaScript">
<!--
var turn = 0
var mode = 0
var jumping = 0
var map = new Array(49)
var systm="C"
var bpos = new Array(37)
var btype = new Array(37)
var bcrowned = new Array(37)
var cstart=-1

var imgs = new Array(20)
imgs[0]=new Image();imgs[0].src="grey.gif"
imgs[1]=new Image();imgs[1].src="red.gif"
imgs[2]=new Image();imgs[2].src="green.gif"

function turncolor(x,y,c)
{
 pos=x+y*7
 if(map[pos+1]>0)
 {
  map[pos+1]=c
  imgchg(pieceat(pos+1),c)
 }
 if(map[pos-1]>0)
 {
  map[pos-1]=c
  imgchg(pieceat(pos-1),c)
 }
 if(map[pos+7]>0)
 {
  map[pos+7]=c
  imgchg(pieceat(pos+7),c)
 }
 if(map[pos-7]>0)
 {
  map[pos-7]=c
  imgchg(pieceat(pos-7),c)
 }
 if (y%2==1)
 {
  if(map[pos+8]>0)
  {
   map[pos+8]=c
   imgchg(pieceat(pos+8),c)
  }
  if(map[pos-6]>0)
  {
   map[pos-6]=c
   imgchg(pieceat(pos-6),c)
  }
 }
 else
 {
  if(map[pos+6]>0)
  {
   map[pos+6]=c
   imgchg(pieceat(pos+6),c)
  }
  if(map[pos-8]>0)
  {
   map[pos-8]=c
   imgchg(pieceat(pos-8),c)
  }
 }
}

function sclick(x,y)		
{   
 if (mode==0)
 {
  valid=0
  if (map[x+y*7+1]==turn+1) valid=2
  if (map[x+y*7-1]==turn+1) valid=2
  if (map[x+y*7+7]==turn+1) valid=2
  if (map[x+y*7-7]==turn+1) valid=2
  if (y%2==1)
  {
   if (map[x+y*7+8]==turn+1)valid=2
   if (map[x+y*7-6]==turn+1)valid=2
  }
  else
  {
   if (map[x+y*7+6]==turn+1)valid=2
   if (map[x+y*7-8]==turn+1)valid=2
  }
  if (map[x+y*7]==(turn+1)%2+1) valid=0
  if (map[x+y*7]==turn+1) valid=1

  if (valid==1)
  {
   mode=1
   cstart=x+y*7
   move(38,x*91-20+(y%2)*44,y*78+30)
   move(37,50,800)
  }
  if (valid==2)
  {
   map[x+y*7]=turn+1
   move(37,50,800)
   move(38,50,800)
   turncolor(x,y,turn+1)
   imgchg(pieceat(x+y*7),turn+1)
   turn=(turn+1)%2

  }
 }
 else 
 {  
  mode=0  
  move(37,50,800)
  move(38,50,800)
  if (canjump(x,y)==1)
  {
   transfer(cstart,x+y*7)
   b=pieceat(x+y*7)
   turncolor(x,y,turn+1)
   turn=(turn+1)%2
  }
 }
}


//highlight
function highlight(x,y)
{


 if (mode==0)
 {
  valid=1
  if (map[x+y*7]!=turn+1) valid=0
  if (map[x+y*7+1]==turn+1) valid=1
  if (map[x+y*7-1]==turn+1) valid=1
  if (map[x+y*7+7]==turn+1) valid=1
  if (map[x+y*7-7]==turn+1) valid=1
  if (y%2==1)
  {
   if (map[x+y*7+8]==turn+1)valid=1
   if (map[x+y*7-6]==turn+1)valid=1
  }
  else
  {
   if (map[x+y*7+6]==turn+1)valid=1
   if (map[x+y*7-8]==turn+1)valid=1
  }
  if (map[x+y*7]==(turn+1)%2+1) valid=0

  if (valid==1)
   move(37,x*91-20+(y%2)*44,y*78+30)
  else
   move(37,50,800)
 }
 else
 {
  if (canjump(x,y)==1)
   move(37,x*91-20+(y%2)*44,y*78+30)
  else
   move(37,50,800)
 }
}

function canjump(x,y)
{
 end = x+y*7
 valid=1
 if (map[end]!=0) valid=0

 return valid
}

function hide()
{ 
   move(37,100,800)
}

function transfer(start,end)
{
 b=pieceat(start)
 c=pieceat(end)
 map[end]=map[start]
 map[start]=0
 imgchg(b,0)
 imgchg(c,map[end])

}

function pieceat(square)
{
 for(a=0;a<37;a++)
  if(bpos[a]==square)
   return a
}



function init()
{
 turn=1
 jumping=0
 mode=0
 cstart=-1

 a=0
 for(y=0;y<7;y++)
 {
  if (y==0) {min=2; max=5}
  if (y==1) {min=1; max=5}
  if (y==2) {min=1; max=6}
  if (y==3) {min=0; max=6}
  if (y==4) {min=1; max=6}
  if (y==5) {min=1; max=5}
  if (y==6) {min=2; max=5}
  for (x=0;x<7;x++)
  {
   if (x>=min && x <=max)
   {
    if (y==0)
    {
     spawn(x*91-20+(y%2)*44,y*78+30,"green.gif",a)
     map[x+y*7]=2
    }
    else if (y==6)
    {
     spawn(x*91-20+(y%2)*44,y*78+30,"red.gif",a)
     map[x+y*7]=1
    }
    else
    {
     spawn(x*91-20+(y%2)*44,y*78+30,"grey.gif",a)
     map[x+y*7]=0
    }
     bpos[a]=x+y*7
    a=a+1
   }
   else
    map[x+y*7]=-1
  }
 }
 spawn(1,1000,"box.gif",37)
 spawn(1,1000,"box2.gif",38)

 spX=12
 spY=15
 if (systm!="C")
 {
  document.write("<LAYER LEFT="+spX+" TOP="+spY+"><IMG SRC='ghost.gif' BORDER=0 USEMAP='#map'></LAYER>")
 }
 else
 {
  with (document) 
  {
   write("<IMG SRC='ghost.gif' STYLE='position:absolute' BORDER=0 USEMAP='#map'>")
   images[39].style.posLeft = spX
   images[39].style.posTop =  spY
  }
 }
}

//IMAGE CHANGE
function imgchg(imgNo,dataNo){
 if (systm!="C"){
  document.layers[0].layers[imgNo].document.images[0].src=imgs[dataNo].src
 }else{
  document.images[imgNo].src=imgs[dataNo].src
 }
}


//LAYER MOVE
function move(spNO,spX,spY){
 if (systm!="C"){
  document.layers[0].layers[spNO].moveTo(spX,spY)
 }else{
  document.images[spNO].style.posLeft = spX
  document.images[spNO].style.posTop =  spY

 }
}


//LAYER SETUP
function spawn(spX,spY,spIMG,spno)
{
 if (systm!="C")
 {
  document.write("<LAYER LEFT="+spX+" TOP="+spY+"><IMG SRC='"+spIMG+"'></LAYER>")
 }
 else
 {
  with (document) 
  {
   write("<IMG SRC='"+spIMG+"' STYLE='position:absolute'>")
   images[spno].style.posLeft = spX
   images[spno].style.posTop =  spY
  }
 }
}

//-->
</SCRIPT>

</head>
<body bgcolor=#000000 text=#ffffff link=#0080ff ONLOAD=startFLG=0>





<SCRIPT LANGUAGE="JavaScript">
<!--
for (a=0;a<64;a++)
{
 map[a]=0
}
init()
//-->
</SCRIPT>
<IMG SRC="board.jpg" border=0>
<img src="ghost.gif">
<img src="ghost.gif">
<!--#wpad--> 


</body>
</html>


